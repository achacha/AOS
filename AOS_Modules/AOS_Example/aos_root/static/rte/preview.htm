<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<STYLE type="text/css">
body {
	margin: 0px;
	padding: 0px;
}
.footer {
	background-color: #DEDCD5;
	border-top: #AAAAAA 1px solid;
	padding:13px;
	padding-top:7px;
	padding-bottom:7px;
	font-family: Tahoma, Arial, Helvetica, sans-serif;
	font-size: 8pt;
}
input {
	font-family: Tahoma, Arial, Helvetica, sans-serif;
	font-size: 8pt;
}
</STYLE>
<title>Preview</title>
<script>
var rte = self.opener.dialogArgs.rte;
var cssFile = self.opener.dialogArgs.cssFile;
var basePath = self.opener.basePath;
var lang = self.opener.lang;

function initPreview()
{
	var pre = document.getElementById("preview").contentWindow;


	var html = '<HTML>\n<HEAD>\n<TITLE>Richtext Editor Preview</TITLE>\n';
	if (typeof cssFile == 'string' && cssFile.length) {
		html += '<link type="text/css" href="' + cssFile + '" rel="stylesheet">\n';
	} else {
		html += '<style>body {background: #FFFFFF;margin: 0px;padding: 0px;}</style>';
	}
	html += '<BODY>\n' + rte.getTextarea().value + '\n</BODY>\n</HTML>';
	pre.document.open();
	pre.document.write(html);
	pre.document.close();

	pre.document.body.style.border = "none";
	document.getElementById('close').value = lang['Close'];
}
</script>
</head>
<body style="overflow:hidden;" onblur="window.focus();">

<table width="100%" height="100%" align="center" cellpadding="0" cellspacing="0">
<td style="height:100%">
	<iframe style="width:100%;height:100%;overflow:auto;" name="preview" id="preview"></iframe>
</td>
</tr>
<tr>
<td class="footer" align="right">
	<input type="button" name="close" id="close" value="" onclick="self.close()" style="width:80px">
</td>
</tr>
</table>

<SCRIPT type="text/javascript">
initPreview();
</SCRIPT>
</body>
</html>